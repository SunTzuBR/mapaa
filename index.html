<!DOCTYPE html>
<html>
<head>
  <title>Te amo Claine</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      margin: 0;
      overflow: hidden; /* Impede a rolagem da página */
    }
    #container {
      position: relative;
      width: 100%;
      height: 100vh; /* Altura total da viewport */
      background-color: #f0f0f0;
      overflow: hidden; /* Impede a exibição de conteúdo fora do contêiner */
    }
    #claine {
      position: absolute;
      padding: 10px 20px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      transition: transform 0.1s ease-out; /* Transição suave para o movimento */
    }
    #claine:hover {
      background-color: #0056b3;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    
    .legend {
      position: absolute;
      bottom: 30px;
      right: 10px;
      width: 40px;
      height: 200px;
      background: linear-gradient(to top, #6495ED, #6A5ACD, #836FFF, #6959CD, #483D8B, #191970, #000080, #00008B, #0000CD, #0000FF, #000033);
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 5px;
    }

    .pointer {
      position: absolute;
      left: 0px;
      width: 50px;
      height: 2px;
      background: black;
    }

    .leaflet-control-attribution {
      display: none;
    }
  </style>
</head>
<body>

<div id="map">
</div>
<div class="legend">
  <div id="pointer" class="pointer"></div>
</div>
  <div id="container">
  <h2>Quem está sempre certo??</h2>
  <div id="botoes">
    <button id="claine" class="botao">Claine</button>
    <button id="christian" class="botao" onclick="alert('Muito bem!')">Christian</button>

  
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
var claineButton = document.getElementById('claine');
  var container = document.getElementById('container');

  // Posição inicial do botão Claine no centro do contêiner
  var claineX = window.innerWidth / 2;
  var claineY = window.innerHeight / 2;

  // Fator de movimento ajustável (quanto menor, mais lento)
  var moveFactor = 0.05;

  function updateClainePosition() {
    // Posição atual do cursor
    var mouseX = container.mouseX || window.innerWidth / 2;
    var mouseY = container.mouseY || window.innerHeight / 2;

    // Direção e distância do botão Claine ao cursor
    var directionX = mouseX - claineX;
    var directionY = mouseY - claineY;
    var distance = Math.sqrt(directionX * directionX + directionY * directionY);

    // Movimento suave em direção ao cursor
    claineX += (directionX / distance) * moveFactor * distance;
    claineY += (directionY / distance) * moveFactor * distance;

    // Limites do contêiner
    var containerRect = container.getBoundingClientRect();
    var minLeft = 0;
    var maxLeft = containerRect.width - claineButton.offsetWidth;
    var minTop = 0;
    var maxTop = containerRect.height - claineButton.offsetHeight;

    // Limita a posição do botão Claine dentro dos limites do contêiner
    claineX = Math.max(minLeft, Math.min(maxLeft, claineX));
    claineY = Math.max(minTop, Math.min(maxTop, claineY));

    // Aplica a posição ao botão Claine
    claineButton.style.left = claineX + 'px';
    claineButton.style.top = claineY + 'px';

    // Atualiza a posição do cursor
    container.mouseX = mouseX;
    container.mouseY = mouseY;

    // Loop do movimento
    requestAnimationFrame(updateClainePosition);
  }

  // Inicia o movimento do botão Claine
  updateClainePosition();

  // Evento de movimento do mouse para atualizar a posição do cursor
  container.addEventListener('mousemove', function(event) {
    container.mouseX = event.clientX;
    container.mouseY = event.clientY;
  });

  // Evento de redimensionamento da janela para atualizar as dimensões do contêiner
  window.addEventListener('resize', function() {
    var containerRect = container.getBoundingClientRect();
    var claineRect = claineButton.getBoundingClientRect();

    // Garante que o botão Claine permaneça visível dentro dos limites do contêiner após o redimensionamento
    claineX = Math.min(claineX, containerRect.width - claineRect.width);
    claineY = Math.min(claineY, containerRect.height - claineRect.height);
  });
// URL do GeoJSON dos municípios de Alagoas
const geojsonUrl = 'AL.json';

// Função para estilizar os polígonos com cores definidas manualmente
function style(feature) {
  const atendimentos = feature.properties.ATENDIMENTOS || 0;

  // Defina as cores manualmente conforme sua métrica
  let fillColor;
  let color = 'white';
  let weight = 1;
  let dashArray = null;

  if (atendimentos === 0) {
    fillColor = '#ffffff'; // Branco para zero atendimentos
    color = 'black';
    dashArray = '3';
  } else if (atendimentos < 20) {
    fillColor = '#6495ED'; // Ajuste as cores conforme necessário
  } else if (atendimentos < 40) {
    fillColor = '#6A5ACD';
  } else if (atendimentos < 60) {
    fillColor = '#483D8B';
  } else if (atendimentos < 80) {
    fillColor = '#000080';
  } else {
    fillColor = '#000033';
  }

  return {
    fillColor: fillColor,
    weight: weight,
    opacity: 1,
    color: color,
    fillOpacity: 0.8,
    dashArray: dashArray
  };
}

// Função para exibir informações ao passar o mouse
function onMouseOver(e) {
  const layer = e.target;
  const properties = layer.feature.properties;
  const atendimentos = properties.ATENDIMENTOS || 0;
  
  layer.bindTooltip(`<strong>${properties.NM_MUNICIP}</strong><br>Número de Atendimentos: ${atendimentos}`).openTooltip();

  // Atualizar a posição do ponteiro na legenda
  updatePointer(atendimentos);
}

// Função para remover informações ao retirar o mouse
function onMouseOut(e) {
  const layer = e.target;
  layer.closeTooltip();
}

// Função para exibir informações detalhadas ao clicar
function onClick(e) {
  const properties = e.target.feature.properties;
  const atendimentos = properties.ATENDIMENTOS || 0;
  
// isso faz aparecer quando clica
  const popupContent = `
    <h3>${properties.NM_MUNICIP}</h3>
    <p><strong>Número de Atendimentos:</strong> ${atendimentos}</p>
    <p><strong>ID:</strong> ${properties.ID}</p>
    <p><strong>Coordenadas:</strong> ${properties.CD_GEOCODM}</p>
  `;
  
  L.popup()
    .setLatLng(e.latlng)
    .setContent(popupContent)
    .openOn(map);
}

// Função para atualizar a posição do ponteiro na legenda
function updatePointer(value) {
  const min = 0;
  const max = 100;
  const range = max - min;
  const percentage = (value - min) / range;
  const pointer = document.getElementById('pointer');
  pointer.style.top = `${(1 - percentage) * 100}%`;
}

  function mostrarMensagem() {
  console.log("Botão clicado! Mensagem exibida no console.");
}
  
// Inicializar o mapa sem camada de base
var map = L.map('map', {
  center: [-9.5733, -36.7820],
  zoom: 8,
  layers: [],  // Remover a camada base
  maxBounds: [
    [-11, -39], // Coordenadas do sudoeste de Alagoas
    [-7, -34]  // Coordenadas do nordeste de Alagoas
  ],
  maxBoundsViscosity: 2.0
});

// Carregar GeoJSON e adicionar ao mapa
fetch(geojsonUrl)
  .then(response => response.json())
  .then(data => {
    L.geoJSON(data, {
      style: style,
      onEachFeature: function(feature, layer) {
        layer.on({
          mouseover: onMouseOver,
          mouseout: onMouseOut,
          click: onClick
        });
      }
    }).addTo(map);
  });

</script>

</body>
</html>
